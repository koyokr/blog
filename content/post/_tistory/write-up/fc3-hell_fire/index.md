---
title: FC3 hell_fire -> evil_wizard
slug: fc3-hell_fire
date: 2017-01-06 00:15:00 +0900 KST
categories: [write-up]
markup: mmark
---

pop pop ret을 어떻게 쓰는 건지 이 문제를 풀고 알게 됐다.

리턴을 이용해서 인자가 2개 필요한 함수를 호출할 때 스택에 아래와 같이 배치시킨다.

[함수주소] [ㅁㄴㅇㄹ] [인자1] [인자2]

함수 호출이 끝나면 이제 ㅁㄴㅇㄹ에 있는 값으로 리턴해서 넘어갈 거고

여기에 pop pop ret이 있는 곳을 적어주면 당연하게도 인자1과 인자2가 삭제되면서 그 다음 스택에 있는 곳으로 리턴하게 된다.

그럼 이렇게 쓸 수 있겠지

[함수주소] [팝팝리턴] [인자1] [인자2]

[함수주소] [팝팝팝렡] [인자1] [인자2] [인자3]

[함수주소] [팝팝리턴] [인자1] [인자2]

ㅁㄴㅇㄹ
